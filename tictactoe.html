<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tic-Tac-Toe - 5 Levels</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        const LEVELS = [
            { id: 1, name: "Beginner", desc: "Random moves - Easy win!", color: "from-green-400 to-green-600" },
            { id: 2, name: "Easy", desc: "Mostly random, occasional smart move", color: "from-blue-400 to-blue-600" },
            { id: 3, name: "Medium", desc: "Blocks wins & takes opportunities", color: "from-yellow-400 to-yellow-600" },
            { id: 4, name: "Hard", desc: "Strategic player - tough to beat", color: "from-orange-400 to-orange-600" },
            { id: 5, name: "Impossible", desc: "Perfect AI - can you draw?", color: "from-red-400 to-red-600" }
        ];

        function TicTacToe() {
            const [board, setBoard] = useState(Array(9).fill(null));
            const [isPlayerTurn, setIsPlayerTurn] = useState(true);
            const [winner, setWinner] = useState(null);
            const [level, setLevel] = useState(3);
            const [stats, setStats] = useState({ wins: 0, losses: 0, draws: 0 });
            const [gameOver, setGameOver] = useState(false);
            const [winningLine, setWinningLine] = useState([]);

            const checkWinner = (squares) => {
                const lines = [
                    [0, 1, 2], [3, 4, 5], [6, 7, 8], // Rows
                    [0, 3, 6], [1, 4, 7], [2, 5, 8], // Columns
                    [0, 4, 8], [2, 4, 6]             // Diagonals
                ];

                for (let line of lines) {
                    const [a, b, c] = line;
                    if (squares[a] && squares[a] === squares[b] && squares[a] === squares[c]) {
                        return { winner: squares[a], line };
                    }
                }
                return { winner: null, line: [] };
            };

            const getEmptySquares = (squares) => {
                return squares.map((val, idx) => val === null ? idx : null).filter(val => val !== null);
            };

            // Level 1: Pure random
            const getRandomMove = (squares) => {
                const empty = getEmptySquares(squares);
                return empty[Math.floor(Math.random() * empty.length)];
            };

            // Level 2: 70% random, 30% smart
            const getEasyMove = (squares) => {
                if (Math.random() < 0.7) {
                    return getRandomMove(squares);
                }
                return getMediumMove(squares);
            };

            // Level 3: Block wins, take wins, otherwise random
            const getMediumMove = (squares) => {
                // Try to win
                const winMove = findWinningMove(squares, 'O');
                if (winMove !== null) return winMove;

                // Block player win
                const blockMove = findWinningMove(squares, 'X');
                if (blockMove !== null) return blockMove;

                // Take center if available
                if (squares[4] === null) return 4;

                // Random
                return getRandomMove(squares);
            };

            // Level 4: Minimax with limited depth
            const getHardMove = (squares) => {
                return minimax(squares, 'O', 0, 4).index; // Depth limit 4
            };

            // Level 5: Full minimax - unbeatable
            const getImpossibleMove = (squares) => {
                return minimax(squares, 'O', 0, Infinity).index;
            };

            const findWinningMove = (squares, player) => {
                const empty = getEmptySquares(squares);
                for (let i of empty) {
                    const testBoard = [...squares];
                    testBoard[i] = player;
                    if (checkWinner(testBoard).winner === player) {
                        return i;
                    }
                }
                return null;
            };

            const minimax = (squares, player, depth, maxDepth) => {
                const { winner } = checkWinner(squares);
                const empty = getEmptySquares(squares);

                if (winner === 'O') return { score: 10 - depth };
                if (winner === 'X') return { score: depth - 10 };
                if (empty.length === 0) return { score: 0 };
                if (depth >= maxDepth) return { score: 0 };

                const moves = [];

                for (let i of empty) {
                    const testBoard = [...squares];
                    testBoard[i] = player;
                    const result = minimax(testBoard, player === 'O' ? 'X' : 'O', depth + 1, maxDepth);
                    moves.push({ index: i, score: result.score });
                }

                if (player === 'O') {
                    // Maximizing player
                    return moves.reduce((best, move) => move.score > best.score ? move : best);
                } else {
                    // Minimizing player
                    return moves.reduce((best, move) => move.score < best.score ? move : best);
                }
            };

            const getAIMove = (squares) => {
                switch(level) {
                    case 1: return getRandomMove(squares);
                    case 2: return getEasyMove(squares);
                    case 3: return getMediumMove(squares);
                    case 4: return getHardMove(squares);
                    case 5: return getImpossibleMove(squares);
                    default: return getRandomMove(squares);
                }
            };

            useEffect(() => {
                if (!isPlayerTurn && !gameOver) {
                    const timer = setTimeout(() => {
                        const aiMove = getAIMove(board);
                        handleMove(aiMove);
                    }, 500);
                    return () => clearTimeout(timer);
                }
            }, [isPlayerTurn, gameOver, board]);

            const handleMove = (index) => {
                if (board[index] || gameOver) return;

                const newBoard = [...board];
                newBoard[index] = isPlayerTurn ? 'X' : 'O';
                setBoard(newBoard);

                const { winner: win, line } = checkWinner(newBoard);
                if (win) {
                    setWinner(win);
                    setWinningLine(line);
                    setGameOver(true);
                    if (win === 'X') {
                        setStats(prev => ({ ...prev, wins: prev.wins + 1 }));
                    } else {
                        setStats(prev => ({ ...prev, losses: prev.losses + 1 }));
                    }
                } else if (getEmptySquares(newBoard).length === 0) {
                    setWinner('draw');
                    setGameOver(true);
                    setStats(prev => ({ ...prev, draws: prev.draws + 1 }));
                } else {
                    setIsPlayerTurn(!isPlayerTurn);
                }
            };

            const resetGame = () => {
                setBoard(Array(9).fill(null));
                setIsPlayerTurn(true);
                setWinner(null);
                setGameOver(false);
                setWinningLine([]);
            };

            const changeLevel = (newLevel) => {
                setLevel(newLevel);
                resetGame();
                setStats({ wins: 0, losses: 0, draws: 0 });
            };

            const currentLevel = LEVELS.find(l => l.id === level);

            return (
                <div className="min-h-screen bg-gradient-to-br from-purple-100 to-pink-100 p-6">
                    <div className="max-w-4xl mx-auto">
                        <div className="bg-white rounded-2xl shadow-2xl p-8">
                            <h1 className="text-4xl font-bold text-center mb-2 text-gray-800">
                                ‚≠ï Tic-Tac-Toe ‚ùå
                            </h1>
                            <p className="text-center text-gray-600 mb-6">Challenge the AI at 5 difficulty levels!</p>

                            {/* Level Selection */}
                            <div className="mb-8">
                                <h2 className="text-lg font-semibold text-gray-700 mb-3 text-center">Select Difficulty</h2>
                                <div className="grid grid-cols-5 gap-2">
                                    {LEVELS.map(lvl => (
                                        <button
                                            key={lvl.id}
                                            onClick={() => changeLevel(lvl.id)}
                                            className={`p-3 rounded-lg font-semibold transition-all ${
                                                level === lvl.id
                                                    ? `bg-gradient-to-r ${lvl.color} text-white shadow-lg scale-105`
                                                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                                            }`}
                                        >
                                            <div className="text-sm">{lvl.name}</div>
                                            <div className="text-xs opacity-75">Lv.{lvl.id}</div>
                                        </button>
                                    ))}
                                </div>
                                <div className={`mt-3 p-3 rounded-lg bg-gradient-to-r ${currentLevel.color} text-white text-center`}>
                                    <p className="font-medium">{currentLevel.desc}</p>
                                </div>
                            </div>

                            {/* Stats */}
                            <div className="grid grid-cols-3 gap-4 mb-6">
                                <div className="bg-green-100 p-4 rounded-lg text-center">
                                    <div className="text-2xl font-bold text-green-700">{stats.wins}</div>
                                    <div className="text-sm text-green-600">Wins</div>
                                </div>
                                <div className="bg-gray-100 p-4 rounded-lg text-center">
                                    <div className="text-2xl font-bold text-gray-700">{stats.draws}</div>
                                    <div className="text-sm text-gray-600">Draws</div>
                                </div>
                                <div className="bg-red-100 p-4 rounded-lg text-center">
                                    <div className="text-2xl font-bold text-red-700">{stats.losses}</div>
                                    <div className="text-sm text-red-600">Losses</div>
                                </div>
                            </div>

                            {/* Game Status */}
                            <div className="text-center mb-6">
                                {!gameOver && (
                                    <div className={`text-xl font-semibold ${isPlayerTurn ? 'text-blue-600' : 'text-red-600'}`}>
                                        {isPlayerTurn ? 'üéÆ Your Turn (X)' : 'ü§ñ AI Thinking... (O)'}
                                    </div>
                                )}
                                {gameOver && winner === 'X' && (
                                    <div className="text-2xl font-bold text-green-600">
                                        üéâ You Win! Great job!
                                    </div>
                                )}
                                {gameOver && winner === 'O' && (
                                    <div className="text-2xl font-bold text-red-600">
                                        üòî AI Wins! Try again!
                                    </div>
                                )}
                                {gameOver && winner === 'draw' && (
                                    <div className="text-2xl font-bold text-gray-600">
                                        ü§ù It's a Draw!
                                    </div>
                                )}
                            </div>

                            {/* Game Board */}
                            <div className="grid grid-cols-3 gap-3 mb-6 max-w-md mx-auto">
                                {board.map((cell, index) => (
                                    <button
                                        key={index}
                                        onClick={() => isPlayerTurn && handleMove(index)}
                                        disabled={!isPlayerTurn || gameOver || cell !== null}
                                        className={`aspect-square text-5xl font-bold rounded-xl transition-all ${
                                            winningLine.includes(index)
                                                ? 'bg-gradient-to-br from-yellow-300 to-yellow-500 shadow-xl scale-105'
                                                : cell === null
                                                ? 'bg-gray-100 hover:bg-gray-200 hover:scale-105'
                                                : 'bg-gradient-to-br from-blue-50 to-purple-50'
                                        } ${
                                            cell === null && isPlayerTurn && !gameOver
                                                ? 'cursor-pointer'
                                                : 'cursor-not-allowed'
                                        } shadow-md`}
                                    >
                                        {cell === 'X' && <span className="text-blue-600">‚úï</span>}
                                        {cell === 'O' && <span className="text-red-600">‚óØ</span>}
                                    </button>
                                ))}
                            </div>

                            {/* Reset Button */}
                            <div className="text-center">
                                <button
                                    onClick={resetGame}
                                    className="bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white font-bold py-3 px-8 rounded-full shadow-lg transition-all hover:scale-105"
                                >
                                    üîÑ New Game
                                </button>
                            </div>
                        </div>

                        <div className="mt-6 text-center text-gray-700">
                            <p className="text-sm">üí° <strong>Pro tip:</strong> Level 5 is mathematically perfect - best you can do is draw!</p>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<TicTacToe />, document.getElementById('root'));
    </script>
</body>
</html>